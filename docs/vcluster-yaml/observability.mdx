---
title: Observability
sidebar_label: observability
description: Configure your metrics provider.
---

import ObservabilityMetrics from '@site/docs/_partials/config/observabilityMetrics.mdx'
import Observability from '@site/docs/_partials/config/observability.mdx'

## Feature overview

:::info
vCluster needs RBAC permissions to access host Node metrics from within the virtual cluster. You enable these permissions when you [enable real nodes synchronization](/architecture/nodes.mdx).
:::

You can monitor your virtual cluster either from the host cluster or directly from within the virtual cluster. 

vCluster is able to rewrite node stats and metrics. This means monitoring a virtual cluster works similar to monitoring a regular Kubernetes cluster. By default, vCluster creates a service for each node which redirects incoming traffic from within the virtual cluster to the node kubelet to vCluster itself. This means that traffic reaches vCluster first if workloads within the virtual cluster try to scrape node metrics. vCluster redirects the incoming request to the host cluster and rewrites the response (pod names, pod namespaces etc) and returns it to the requester.

vCluster exposes metrics endpoints on `https://0.0.0.0:8443/metrics` (syncer metrics) and `https://0.0.0.0:6444/metrics` (k3s metrics). In order to scrape those metrics, you need to send an `Authorization` header with a valid virtual cluster service account token that has permissions to access the `/metrics` endpoint within the vcluster.

## Enable the metrics server proxy

:::info
This feature requires a working metrics server installation on the host cluster.
:::

You can proxy the metrics server in the underlying host cluster and get the `pod`/`node` metrics individually or both of them according to the use case. Enable this behavior with the following values:

```
observability:
  metrics:
    proxy:
      nodes:
        enabled: true
      pods:
        enabled: true
```

## Config reference

```yaml
observability:
  serviceMonitor:
    enabled:
  metrics:
    proxy:
      nodes:
        enabled:
      pods:
        enabled:
```

generated observabilityMetrics.mdx:


<ObservabilityMetrics />

generated observability.mdx:
@TODO what is `serviceMonitor`?
<Observability />