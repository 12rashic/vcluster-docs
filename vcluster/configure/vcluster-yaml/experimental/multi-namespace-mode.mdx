---
title: Multiple namespace mode config
sidebar_label: multiNamespaceMode
sidebar_position: 4
description: Configure multiple namespace mode.
---

import MultiNamespaceMode from '@site/vcluster/_partials/config/experimental/multiNamespaceMode.mdx'

By default, vCluster uses a single namespace to sync all resources to. vCluster avoids naming conflicts, where multiple resources could have the same name, but be in different namespaces within the vCluster, by rewriting the name of the resource in the host cluster.

For example, a pod within the vCluster called `test` in namespace `my-namespace` is rewritten for the host cluster to `test-x-my-namespace-x-my-vcluster` to avoid conflicts with other pods that would be named `test` and to allow creating multiple vClusters within the same namespace.

Because vCluster rewrites the resource name, all references from other objects to that resource will need to get rewritten as well. vCluster does this already for all core resources, e.g. mounting a secret in a pod within the vCluster is automatically rewritten to the correct secret name on the host cluster (without seeing that inside the vCluster).

However, when using features such as [syncing custom resources](../sync/to-host/advanced/custom-resource-definitions), it can be tedious to add all used references, or it can become difficult or even impossible to rewrite certain references.

Hence, vCluster offers a second mode of operation, **Multi-Namespace-Mode** which is more tailored towards syncing custom resources where vCluster will create a namespace in the host cluster for each namespace in the virtual cluster. vCluster will now only modify the Namespace name to avoid conflicts between multiple vCluster instances in the same host.

This has the advantage that name references do not need to get rewritten anymore, because the name within the vCluster and host cluster stay the same, which makes syncing custom resources a lot easier.

:::warning
Do not switch the vCluster mode in an already running vCluster, this will cause serious data loss!
:::

## Single-Namespace Mode vs Multi-Namespace Mode

### Single-Namespace Mode (default)

#### Choose this if you:

* Not want to sync any CRDs or just CRDs with only a few references to other resources (e.g. Cert Manager or External Secrets)
* Not have any global cluster permissions

#### Advantages:
* No cluster-level permissions required
* Single namespace per vCluster
* Easier isolation (single resource quota, limit range etc. per vCluster)

#### Disadvantages:
* Resource names on the host cluster are called differently than in the vCluster
* More complex to sync complex CRDs because of rewritten names (need to configure references on CRDs)

### Multi-Namespace Mode

#### Choose this if you:
* Want to sync more complex CRDs (e.g. Knative, Zalando Postgresql or Tekton)
* Are fine with vCluster creating new namespaces on its own

#### Advantages:
* Resource names on the host cluster are called the same than in the vCluster
* Easier to sync CRDs (no need to configure references)
* Easier migration of resources into the vCluster

#### Disadvantages:
* Requires global cluster permissions
* More effort to isolate multiple namespaces via quotas & policies


## Enabling Multi-Namespace-Mode

To enable multi-namespace-mode, just enable the following setting in your `vcluster.yaml`:
```yaml
experimental:
  multiNamespaceMode:
    enabled: true
```

## Config reference

<MultiNamespaceMode/>
